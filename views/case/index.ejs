<% layout('layouts/boilerplate')%>
<h1 class="display-6 text-success text-center mb-3">سجل باقات المستثمرين</h1>
<form class="d-flex shadow-sm mx-5">
  <input
    id="search"
    class="form-control mb-2"
    type="search"
    placeholder="خانة البحث"
    aria-label="Search"
    autocomplete="off"
  />
</form>
<div class="table-responsive shadow-sm mx-5">
  <table
    class="table table-striped table-hover table-borderless text-center sortable"
  >
    <thead class="table-greenSea">
      <tr>
        <th scope="col">الرقم</th>
        <th scope="col">رقم المرجع</th>
        <th scope="col">الاسم الكامل</th>
        <th scope="col">الباقة / المدة</th>
        <th scope="col">المبلغ</th>
        <th scope="col">تاريخ البداية</th>
        <th scope="col">تاريخ النهاية</th>
        <th scope="col">المدة المتبقية</th>
        <th scope="col">حالة الباقة</th>
        <th scope="col">العمليات</th>
      </tr>
    </thead>
    <tbody id="tablebody">
      <% var i=1 %> <% for (casee of casees){%>
      <tr>
        <th scope="row" scope="row"  class="clickable"
        onclick="window.location='/withdraw/<%=casee.id%>'"><%= i%> <% i=i+1; %></th>

        <td scope="row"  class="clickable"
        onclick="window.location='/withdraw/<%=casee.id%>'"><%= casee.reference%></td>
        <td scope="row"  class="clickable"
        onclick="window.location='/withdraw/<%=casee.id%>'"><%= casee.user.fullname%></td>
        <td scope="row"  class="clickable"
        onclick="window.location='/withdraw/<%=casee.id%>'">
          <%= casee.pack.title%> / <%= casee.pack.period%> <%=
          casee.pack.unite%>
        </td>
        <td scope="row"  class="clickable"
        onclick="window.location='/withdraw/<%=casee.id%>'"><%= casee.initAmount.toLocaleString('de-DE', { minimumFractionDigits: 2 })%> دج</td>
        <td scope="row"  class="clickable"
        onclick="window.location='/withdraw/<%=casee.id%>'"><%= moment(casee.startDate).format("YYYY-MM-DD")%></td>
        <td scope="row"  class="clickable"
        onclick="window.location='/withdraw/<%=casee.id%>'"><%= moment(casee.endDate).format("YYYY-MM-DD")%></td>
        <td scope="row"  class="clickable"
        onclick="window.location='/withdraw/<%=casee.id%>'">
          <div
            class="progress border border-tealdeer text-white bg-poseidon"
            style="
              font-size: 18px;
              font-weight: bold;
              height: 31px;
              max-width: auto;
              margin: auto;
            "
          >
            <div
              class="progress-bar bg-desertSand"
              role="progressbar"
              style="width: '<%= casee.daysPersent %>'"
              aria-valuenow="25"
              aria-valuemin="0"
              aria-valuemax="<%= casee.nbrDays%>"
            >
              <%= casee.pastDays%>
            </div>
            <div class="align-self-center justify-content-center flex-fill">
             
              <%= casee.restDays%>
            </div>
          </div>
        </td >
        <% if (casee.state==="Active" ){%>
        <td scope="row"  class="clickable"
        onclick="window.location='/withdraw/<%=casee.id%>'">
          <div class="rounded-3 bg-success progress-bar-striped text-white">
            نشطة
          </div>
        </td>

        <%}else{%>
        <td scope="row"  class="clickable"
        onclick="window.location='/withdraw/<%=casee.id%>'">
          <div class="rounded-3 bg-danger progress-bar-striped text-white">
            منتهية
          </div>
        </td>
        <%}%>

        <td><%- include("./delete") %></td>
      </tr>
      <%}%>
    </tbody>
  </table>
</div>
